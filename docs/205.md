# Raspberry Pi ç”¨ Java æ§åˆ¶ç›´æµç”µæœºçš„é€Ÿåº¦å’Œæ–¹å‘

> [https://javatutorial.net/raspberry-pi-control-dc-motor-speed-and-direction-java](https://javatutorial.net/raspberry-pi-control-dc-motor-speed-and-direction-java)

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Raspberry Pi å’Œ Java æ§åˆ¶ç›´æµç”µæœºçš„æ–¹å‘å’Œé€Ÿåº¦ã€‚

æˆ‘æ”¶åˆ°äº†ä¸€äº›è¦æ±‚åˆ›å»ºæœ‰å…³ä½¿ç”¨ Raspberry Pi å’Œ Java æ§åˆ¶ç”µæœºé€Ÿåº¦å’Œæ–¹å‘çš„æ•™ç¨‹çš„è¯·æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å§‹å§ï¼ åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ L293D èŠ¯ç‰‡åŒæ—¶æ§åˆ¶å’Œä¸¤ä¸ªç”µæœºçš„çš„**æ–¹å‘å’Œé€Ÿåº¦**ã€‚

![](img/1ff5dd9584e3bd907a886bd2d7c6d8bf.jpg)

## ç¡¬ä½“éœ€æ±‚

æ‚¨å°†éœ€è¦ä»¥ä¸‹ç»„ä»¶æ¥éµå¾ªæœ¬æ•™ç¨‹ï¼š

*   å·²å®‰è£…æœ€æ–° Raspbian çš„ Raspberry Piï¼ˆäº†è§£å¦‚ä½•[å®‰è£…å’Œé…ç½® Raspbian](https://javatutorial.net/install-raspbian-to-sd-card "Install Raspbian to SD Card") ï¼‰
*   ç”¨äºè¿æ¥æ‰€æœ‰ç»„ä»¶çš„é¢åŒ…æ¿
*   ä¸€é¢— L293D èŠ¯ç‰‡
*   1 æˆ– 2 ä¸ªç›´æµç”µæœºï¼ˆç¬¬äºŒä¸ªä¸ºå¯é€‰ï¼‰ï¼Œé¢å®šç”µå‹ä¸º 4.5V è‡³ 36V
*   ç”µæ± ç»„å¯ä¸ºæ‚¨çš„ç”µæœºæä¾›æ­£ç¡®çš„ç”µå‹
*   å‡ æ ¹ç”µç¼†å¯ä»¥è¿æ¥ä¸€åˆ‡

![Hardware components](img/a61149016e33841f9c18ba0c010810e3.jpg)

ç¡¬ä»¶éƒ¨ä»¶

## L293D

L293D æ˜¯ç”¨äºç›´æµæˆ–æ­¥è¿›ç”µæœºçš„åŒ H æ¡¥ç”µæœºé©±åŠ¨å™¨ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥åŒå‘é©±åŠ¨ä¸¤ä¸ªç›´æµç”µæœºæˆ–ä¸€ä¸ªæ­¥è¿›ç”µæœºã€‚ L293D çš„ä¼˜ç‚¹åœ¨äºï¼Œå®ƒå†…ç½®æœ‰å›å¼¹ä¿æŠ¤åŠŸèƒ½ï¼Œå¯é˜²æ­¢æŸå Raspberry Piã€‚

**åˆ‡å‹¿å°†ç”µæœºç›´æ¥è¿æ¥åˆ° Raspberry Piã€‚ è¿™å¯èƒ½ä¼šä¸¥é‡æŸåæ‚¨çš„ Piï¼**

![L293D Datasheet](img/d6b8ed0475310d6fe2a65d11955cdb4b.jpg)

L293D èµ„æ–™è¡¨

è¯¥èŠ¯ç‰‡æœ‰ä¸¤ä¸ª+ V å¼•è„šã€‚ å¼•è„šå· 8ï¼ˆ+ Vmotorï¼‰ä¸ºç”µæœºä¾›ç”µï¼Œè€Œå¼•è„š 16 ä¸ºèŠ¯ç‰‡æœ¬èº«ä¾›ç”µã€‚ æˆ‘ä»¬å°†å¼•è„š 8 è¿æ¥åˆ°ç”µæ± ç»„ï¼Œå°†å¼•è„š 16 è¿æ¥åˆ° Raspberry çš„ 5V å¼•è„šã€‚

## é€‰æ‹©åˆé€‚çš„ç›´æµç”µæœº

æ‚¨éœ€è¦é€‰æ‹© 4.5V è‡³ 36V çš„ç›´æµç”µæœºã€‚ L293D æ— æ³•åœ¨ 3V ç”µæœºä¸Šæ­£å¸¸å·¥ä½œï¼Œå¹¶ä¸”æ¯ä¸ªé€šé“çš„é™åˆ¶ä¸º 600mAã€‚

## è½¯ä»¶éœ€æ±‚

æˆ‘çš„æ‰€æœ‰æ•™ç¨‹éƒ½ä½¿ç”¨ [Pi4J](http://pi4j.com/) ã€‚ Pi4J æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„åº“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Java ç¼–ç¨‹è¯­è¨€æ¥æ§åˆ¶ Pi çš„ GPIO å¼•è„šã€‚ æ‚¨å¯ä»¥åœ¨ [Raspberry Pi Java æ•™ç¨‹](https://javatutorial.net/raspberry-pi-java-tutorial)å…¥é—¨ä¸­æ‰¾åˆ°æœ‰å…³å¦‚ä½•åœ¨ Raspberry å’Œ IDE ä¸Šå®‰è£…å’Œé…ç½® Pi4J çš„è¯¦ç»†è¯´æ˜ã€‚

## ç»„è£…ç”µè·¯

ç»„è£…ç”µè·¯æ—¶ï¼Œè¯·åŠ¡å¿…æ–­å¼€ Raspberry Pi çš„ç”µæºï¼ å¦åˆ™å¯èƒ½ä¼šæŸå Pi æˆ–ç»„ä»¶ã€‚ æ’å…¥ Pi ä¹‹å‰ï¼Œè¯·åŠ¡å¿…ä»”ç»†æ£€æŸ¥æ¥çº¿ï¼

è¯·ä½¿ç”¨ä¸‹å›¾ç»„è£…ç”µè·¯ã€‚

![Hardware setup for Raspberry Pi 3 to control one DC motor with L293D and Java in both directions](img/30020dfae06300dc0c72dee21f646177.jpg)

Raspberry Pi 3 çš„ç¡¬ä»¶è®¾ç½®ï¼Œä»¥é€šè¿‡ L293D å’Œ Java åŒå‘æ§åˆ¶ä¸€å°ç›´æµç”µæœº

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ GPIO å¼•è„šçš„ç‰©ç†ç¼–å·ã€‚ ç‰©ç†ç¼–å·æŒ‡çš„æ˜¯é€šè¿‡ç®€å•åœ°ä»å·¦ä¸Šè§’çš„æ’é’ˆ 1 ç®—èµ·å¹¶å‘ä¸‹è®¡æ•°çš„æ’é’ˆã€‚

æŸ¥çœ‹ä¸‹å›¾ï¼Œè¯¥å›¾æ˜¾ç¤ºäº†ç‰©ç†å¼•è„šç¼–å·å’Œ Pi4J æ˜ å°„ã€‚ ä¾‹å¦‚ï¼Œç‰©ç†é’ˆè„šç¼–å· 12 åœ¨ Pi4J ä¸­è¢«å‘½åä¸ºé’ˆè„šï¼ƒ1ã€‚ åœ¨æœ¬æ•™ç¨‹åé¢çš„éƒ¨åˆ†ä¸­ç¼–å†™ Java ç¨‹åºæ—¶ï¼Œè¯·ç‰¢è®°è¿™ä¸€ç‚¹ã€‚ [æ‚¨å¯ä»¥åœ¨ Pi4J å®˜æ–¹ç½‘ç«™ä¸­æ‰¾åˆ°æœ‰å…³å¼•è„šç¼–å·çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯](http://pi4j.com/pins/model-3b-rev1.html)ã€‚

![Raspberry Pi 3 Model B Pins and Pi4J mapping](img/050da66a695b9e54b9c49eb17d69e5d2.jpg)

Raspberry Pi 3 Model B å¼•è„šå’Œ Pi4J æ˜ å°„

æ³¨æ„ï¼šæœ¬æ•™ç¨‹æ˜¯é’ˆå¯¹ Raspberry Pi 3 B å‹åˆ¶ä½œçš„ï¼Œå½“ç„¶ï¼Œæ‚¨å¯ä»¥åœ¨ Raspberry Pi 1 æˆ– 2 ä¸­æ„å»ºç›¸åŒçš„ç”µè·¯å¹¶ä½¿ç”¨ç›¸åŒçš„ Java ä»£ç  - åªéœ€æ³¨æ„å¼•è„šç¼–å·å³å¯ã€‚

1.  å°† L293D å¼•è„šï¼ƒ16 è¿æ¥åˆ° Pi ç‰©ç†å¼•è„šï¼ƒ2ï¼ˆ5.0 VDC ç”µæºï¼‰
2.  å°† L293D çš„é’ˆè„š 4ï¼Œé’ˆè„š 5ï¼Œé’ˆè„š 12 å’Œé’ˆè„š 13 è¿æ¥åˆ° Pi ç‰©ç†é’ˆè„š 6ï¼ˆæ¥åœ°ï¼‰
3.  å°† L293D çš„ 8 å·é’ˆè„šè¿æ¥åˆ°ç”µæ± ç»„
4.  å°† L293D çš„é’ˆè„šï¼ƒ3 å’Œï¼ƒ6 è¿æ¥åˆ°ç”µæœº
5.  å°† L293D å¼•è„š 1 è¿æ¥åˆ° Pi ç‰©ç†å¼•è„š 22
6.  å°† L293D å¼•è„š 2 è¿æ¥åˆ° Pi ç‰©ç†å¼•è„š 18
7.  å°† L293D é’ˆè„šï¼ƒ7 è¿æ¥åˆ° Pi ç‰©ç†é’ˆè„šï¼ƒ16

æˆ‘è¿˜å°†åœ¨æ­¤å¤„å‘å¸ƒç”µè·¯åŸç†å›¾ä»¥ä¾›å‚è€ƒ

![Raspberry Pi and L293D one motor schematic](img/fbe86bff895934c3458b72c633f86491.jpg)

Raspberry Pi å’Œ L293D ä¸€å°ç”µæœºåŸç†å›¾

å…·æœ‰ 1 ä¸ªç”µæœºçš„ç»„è£…ç”µè·¯çš„ç…§ç‰‡

![Picture of the 1 motor setup](img/5592f556245960d1901385597056a66c.jpg)

1 ç”µæœºè®¾ç½®çš„å›¾ç‰‡

## Java ç¨‹åºï¼šæ§åˆ¶ä¸€å°ç›´æµç”µæœºçš„æ–¹å‘

è¿™é‡Œæ˜¯æœ‰è¶£çš„éƒ¨åˆ†ã€‚ è¿æ¥å®Œæ‰€æœ‰å†…å®¹åï¼Œæ‚¨å¯ä»¥æ‰“å¼€è‡ªå·±å–œæ¬¢çš„ Java IDE å¹¶ç¼–å†™ä»£ç ã€‚ ä¸‹é¢çš„ä»£ç å°†ä½¿ç”µæœºæ²¿ä¸€ä¸ªæ–¹å‘æ—‹è½¬ 3 ç§’é’Ÿï¼Œç„¶åä½¿ç”µæœºæ²¿ç›¸åæ–¹å‘æ—‹è½¬ 6 ç§’é’Ÿã€‚

```java
import com.pi4j.io.gpio.GpioController;
import com.pi4j.io.gpio.GpioFactory;
import com.pi4j.io.gpio.GpioPinDigitalOutput;
import com.pi4j.io.gpio.RaspiPin;

/**
 * Controls motor direction of a single motor
 * @author https://javatutorial.net
 */
public class ControlOneMotorDirection {

	public static void main(String[] args) throws InterruptedException {
		// get a handle to the GPIO controller
		final GpioController gpio = GpioFactory.getInstance();

		final GpioPinDigitalOutput pinA = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_04, "PinA");
		final GpioPinDigitalOutput pinB = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_05, "PinB");
		final GpioPinDigitalOutput pinE = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_06, "PinE");

		System.out.println("rotate motor clockwise for 3 seconds");
		pinA.high();
		pinB.low();
		pinE.high();

		// wait 3 seconds
		Thread.sleep(3000);

		System.out.println("rotate motor in oposite derection for 6 seconds");
		pinA.low();
		pinB.high();

		// wait 6 seconds
		Thread.sleep(6000);

		// stop motor
		System.out.println("Stopping motor");
		pinE.low();

		gpio.shutdown();
	}
}

```

é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ•°å­—è¾“å‡º pinA æ˜ å°„åˆ° GPIO å¼•è„š 4ï¼Œå°† pinB æ˜ å°„åˆ° GPIO å¼•è„š 5ï¼Œå°† pinE æ˜ å°„åˆ° GPIO å¼•è„š 6ã€‚ å¦‚æœæ‚¨æƒ³çŸ¥é“ä¸ºä»€ä¹ˆåœ¨ä»£ç ä¸­ä½¿ç”¨å¼•è„š 4ã€5 å’Œ 6ï¼Œè¯·å†æ¬¡æŸ¥çœ‹ä¸Šé¢å‘å¸ƒçš„ Pi4J æ˜ å°„å›¾ã€‚ pinE åç§°æ¥è‡ªâ€œ pin enableâ€ã€‚

å¦‚æœ pinE ä¸ºé«˜ç”µå¹³ï¼Œåˆ™è¯´æ˜ç”µæœºå·²æ‰“å¼€ã€‚ å°† pinE ç½®äºä½ç”µå¹³å°†å…³é—­ç”µæœºã€‚ æˆ‘ä»¬é€šè¿‡å°†å¼•è„š A æˆ– B ä¹‹ä¸€åˆ‡æ¢åˆ°é«˜ç”µå¹³å¹¶å°†å¦ä¸€ä¸ªå¼•è„šåˆ‡æ¢åˆ°ä½ç”µå¹³æ¥ç¡®å®šæ—‹è½¬æ–¹å‘ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å°† pinA è®¾ç½®ä¸ºé«˜ç”µå¹³å¹¶å°† pinB è®¾ç½®ä¸ºä½ç”µå¹³ï¼Œåˆ™ç”µæœºå°†é¡ºæ—¶é’ˆæ—‹è½¬ã€‚ äº¤æ¢é”€é’‰ï¼Œç”µæœºå°†ä»¥ç›¸åçš„æ–¹å‘æ—‹è½¬ã€‚

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ Raspberry ä¸Šæ‰§è¡Œç¨‹åº

```java
sudo java -classpath .:classes:/opt/pi4j/lib/'*' ControlOneMotorDirection
```

ä»¥ä¸‹è§†é¢‘æ¼”ç¤ºäº†ç»“æœ

<https://www.youtube.com/embed/pim_hLJD5IE>

## æ·»åŠ ç¬¬äºŒå°ç”µæœºï¼ˆå¯é€‰ï¼‰

ä½¿ç”¨ L293Dï¼Œæˆ‘ä»¬å¯ä»¥ç‹¬ç«‹æ§åˆ¶ 2 ä¸ªç”µæœºçš„æ–¹å‘ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸å°è¯•è¿™æ ·åšå‘¢ï¼Ÿ åœ¨ç”µè·¯ä¸­æ·»åŠ ç¬¬äºŒä¸ªç”µæœºå¾ˆå®¹æ˜“â€“åªéœ€å°†ç¬¬äºŒä¸ªç”µæœºæ’å…¥é¢åŒ…æ¿ï¼Œå¹¶ä½¿ç”¨ 3 æ¡é¢å¤–çš„ç”µç¼†å°† L293D èŠ¯ç‰‡çš„å¦å¤– 3 ä¸ªå¼•è„šè¿æ¥åˆ° Raspberry Piã€‚

![Raspberry Pi control 2 motors](img/9108d6b5cc1cd3a559a3d620873156a7.jpg)

æ ‘è“æ´¾æ§åˆ¶ 2 å°ç”µæœº

è¿™æ˜¯ç»„è£…ç”µè·¯çš„å›¾ç‰‡â€“ 2 ä¸ªç”µæœºè®¾ç½®

![Raspberry Pi circuit with L293D and two DC motors](img/068547022561d4ce3690e652f69bfe9a.jpg)

å…·æœ‰ L293D å’Œä¸¤ä¸ªç›´æµç”µæœºçš„ Raspberry Pi ç”µè·¯

## Java ç¨‹åºï¼šæ§åˆ¶ä¸¤ä¸ªç›´æµç”µæœºçš„æ–¹å‘

æˆ‘ä»¬å°†æˆ‘ä»¬çš„ç¬¬ä¸€ç”µæœºç§°ä¸º`motor1`ï¼Œç¬¬äºŒä¸ªç”µæœºç§°ä¸º`motor2`ã€‚ æˆ‘ä»¬ä¸º Raspberry Pi åˆ†é…äº† 3 ä¸ª GPIO å¼•è„šï¼Œåˆ†åˆ«æ˜¯ 0ã€2 å’Œ 3ã€‚

ä¸‹é¢çš„ Java ç¨‹åºå°†ä¸¤ä¸ªç”µæœºæ²¿ä¸€ä¸ªæ–¹å‘æ—‹è½¬ 3 ç§’é’Ÿï¼Œç„¶åå°†ç¬¬ä¸€ç”µæœºåå‘æ—‹è½¬ 3 ç§’é’Ÿï¼Œå°†ç¬¬äºŒç”µæœºæ—‹è½¬ 6 ç§’é’Ÿã€‚

```java
import com.pi4j.io.gpio.GpioController;
import com.pi4j.io.gpio.GpioFactory;
import com.pi4j.io.gpio.GpioPinDigitalOutput;
import com.pi4j.io.gpio.RaspiPin;

/**
 * Controls motor direction of a two DC motors
 * @author https://javatutorial.net
 */
public class ControlTwoMotorsDirection {

	public static void main(String[] args) throws InterruptedException {
		// get a handle to the GPIO controller
		final GpioController gpio = GpioFactory.getInstance();

		final GpioPinDigitalOutput motor1pinA = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_04, "m1A");
		final GpioPinDigitalOutput motor1pinB = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_05, "m1B");
		final GpioPinDigitalOutput motor1pinE = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_06, "m1E");
		final GpioPinDigitalOutput motor2pinA = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_00, "m2A");
		final GpioPinDigitalOutput motor2pinB = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_02, "m2B");
		final GpioPinDigitalOutput motor2pinE = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_03, "m2E");

		System.out.println("rotate both motors clockwise for 3 seconds");
		motor1pinA.high();
		motor1pinB.low();
		motor1pinE.high();
		motor2pinA.high();
		motor2pinB.low();
		motor2pinE.high();

		// wait 3 seconds
		Thread.sleep(3000);

		System.out.println("rotate motor 1 in oposite derection for 3 seconds "
				+ "and motor 2 in oposite direction for 6 seconds");
		motor1pinA.low();
		motor1pinB.high();
		motor2pinA.low();
		motor2pinB.high();

		// wait 3 seconds
		Thread.sleep(3000);
		System.out.println("Stopping motor 1");
		motor1pinE.low();

		// wait 3 seconds
		Thread.sleep(3000);
		System.out.println("Stopping motor 2");
		motor2pinE.low();

		gpio.shutdown();
	}
}

```

æˆ‘ä»¬åœ¨æ­¤å¤„ä½¿ç”¨ç›¸åŒçš„è§„åˆ™ï¼šå¦‚æœ pinEï¼ˆå¯ç”¨ï¼‰ä¸ºé«˜ï¼Œåˆ™è¡¨æ˜ç”µæœºå·²æ‰“å¼€ã€‚ å°† pinE ç½®äºä½ç”µå¹³å°†å…³é—­ç”µæœºã€‚ æˆ‘ä»¬é€šè¿‡å°†å¼•è„š A æˆ– B ä¹‹ä¸€åˆ‡æ¢åˆ°é«˜ç”µå¹³å¹¶å°†å¦ä¸€ä¸ªå¼•è„šåˆ‡æ¢åˆ°ä½ç”µå¹³æ¥ç¡®å®šæ—‹è½¬æ–¹å‘ã€‚

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ Raspberry ä¸Šæ‰§è¡Œç¨‹åº

```java
sudo java -classpath .:classes:/opt/pi4j/lib/'*' ControlTwoMotorsDirection
```

ä»¥ä¸‹è§†é¢‘æ¼”ç¤ºäº†ç»“æœ

<https://www.youtube.com/embed/b7Fx7Q_qfUs>

## Java ç¨‹åºï¼šæ§åˆ¶ä¸¤ä¸ªç›´æµç”µæœºçš„é€Ÿåº¦å’Œæ–¹å‘

æœ€åï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•æ§åˆ¶ä¸¤ä¸ªç›´æµç”µæœºçš„**é€Ÿåº¦å’Œæ–¹å‘**ã€‚ æˆ‘ä»¬å°†ä¸ºä¸¤ä¸ªç”µæœºè®¾ç½®ä½¿ç”¨ç›¸åŒçš„ç”µè·¯ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬å°†ä»¥ç¼–ç¨‹æ–¹å¼ä¾é  Soft PWM æ¥æ§åˆ¶ç”µæœºçš„é€Ÿåº¦ã€‚ æ‚¨å¯ä»¥åœ¨æˆ‘çš„æ•™ç¨‹ä¸­é˜…è¯»æœ‰å…³ PWM çš„æ›´å¤šä¿¡æ¯ã€‚[å…·æœ‰ PWM å’Œ Java çš„ Raspberry Pi è°ƒå…‰ LED](https://javatutorial.net/raspberry-pi-dim-led-pwm-java)

çœ‹ä¸‹é¢çš„ java ä»£ç ã€‚ æ³¨æ„ï¼Œç”µæœº 1 å’Œ 2 çš„å¼•è„š A å’Œ B è®¾ç½®ä¸º Soft PWM å¼•è„šã€‚ å¯¹äºä½¿èƒ½å¼•è„šï¼ˆ`motor1pinE`å’Œ`motor2pinE`ï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸å…ˆå‰ä»£ç å®Œå…¨ç›¸åŒçš„å®šä¹‰ã€‚

ä¸€æ—¦æ‰§è¡Œï¼Œç¨‹åºå°†ï¼š

1.  ä»¥ 15% çš„é€Ÿåº¦é¡ºæ—¶é’ˆæ—‹è½¬ç”µæœº 1 2 ç§’é’Ÿ
2.  ä»¥ 60% çš„é€Ÿåº¦é¡ºæ—¶é’ˆæ—‹è½¬ç”µæœº 1 2 ç§’é’Ÿ
3.  ä»¥å…¨é€Ÿå°†ç”µæœº 1 é¡ºæ—¶é’ˆæ—‹è½¬ 2 ç§’
4.  ä»¥ 50% çš„é€Ÿåº¦æ²¿ç›¸åæ–¹å‘æ—‹è½¬ç”µæœº 1 3 ç§’é’Ÿ
5.  åœæ­¢é©¬è¾¾ 1
6.  ä»¥ 30% çš„é€Ÿåº¦é¡ºæ—¶é’ˆæ—‹è½¬ç”µæœº 2 2 ç§’
7.  ä»¥ç›¸åçš„æ–¹å‘å°†ç”µæœº 2 å…¨é€Ÿæ—‹è½¬ 3 ç§’é’Ÿ
8.  åœæ­¢é©¬è¾¾ 2

```java
import com.pi4j.io.gpio.GpioController;
import com.pi4j.io.gpio.GpioFactory;
import com.pi4j.io.gpio.GpioPinDigitalOutput;
import com.pi4j.io.gpio.RaspiPin;
import com.pi4j.wiringpi.SoftPwm;

/**
 * Controls motor speed and direction of two DC motors
 * @author https://javatutorial.net
 */
public class ControlMotorsDirectionAndSpeed {

	private static int MOTOR_1_PIN_A = 4;
	private static int MOTOR_1_PIN_B = 5;
	private static int MOTOR_2_PIN_A = 0;
	private static int MOTOR_2_PIN_B = 2;

	public static void main(String[] args) throws InterruptedException {
		// get a handle to the GPIO controller
		final GpioController gpio = GpioFactory.getInstance();

		// init soft PWM pins
		// softPwmCreate(int pin, int value, int range)
		// the range is set like (min=0 ; max=100)
		SoftPwm.softPwmCreate(MOTOR_1_PIN_A, 0, 100);
		SoftPwm.softPwmCreate(MOTOR_1_PIN_B, 0, 100);
		SoftPwm.softPwmCreate(MOTOR_2_PIN_A, 0, 100);
		SoftPwm.softPwmCreate(MOTOR_2_PIN_B, 0, 100);

		// init GPIO pins
		final GpioPinDigitalOutput motor1pinE = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_06, "m1E");
		final GpioPinDigitalOutput motor2pinE = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_03, "m2E");

		System.out.println("rotate motor 1 clockwise at 15% speed for 2 seconds");
		motor1pinE.high();
		SoftPwm.softPwmWrite(MOTOR_1_PIN_A, 15);

		// wait 2 seconds
		Thread.sleep(2000);

		System.out.println("rotate motor 1 clockwise at 60% speed for 2 seconds");
		SoftPwm.softPwmWrite(MOTOR_1_PIN_A, 60);

		// wait 2 seconds
		Thread.sleep(2000);

		System.out.println("rotate motor 1 clockwise at full speed for 2 seconds");
		SoftPwm.softPwmWrite(MOTOR_1_PIN_A, 100);

		// wait 2 seconds
		Thread.sleep(2000);

		System.out.println("rotate motor 1 in opposite direction at 50% speed for 3 seconds");
		SoftPwm.softPwmWrite(MOTOR_1_PIN_A, 0);
		SoftPwm.softPwmWrite(MOTOR_1_PIN_B, 50);

		// wait 3 seconds
		Thread.sleep(3000);

		// disable motor 1
		SoftPwm.softPwmWrite(MOTOR_1_PIN_B, 0);
		motor1pinE.low();

		System.out.println("rotate motor 2 clockwise at 30% speed for 2 seconds");
		motor2pinE.high();
		SoftPwm.softPwmWrite(MOTOR_2_PIN_A, 30);

		// wait 2 seconds
		Thread.sleep(2000);

		System.out.println("rotate motor 2 in opposite direction at 100% speed for 3 seconds");
		SoftPwm.softPwmWrite(MOTOR_2_PIN_A, 0);
		SoftPwm.softPwmWrite(MOTOR_2_PIN_B, 100);

		// wait 3 seconds
		Thread.sleep(3000);

		// disable motor 2
		SoftPwm.softPwmWrite(MOTOR_2_PIN_B, 0);
		motor2pinE.low();

		gpio.shutdown();
	}
}
```

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ Raspberry ä¸Šæ‰§è¡Œç¨‹åº

```java
sudo java -classpath .:classes:/opt/pi4j/lib/'*' ControlMotorsDirectionAndSpeed
```

è¿è¡Œç¨‹åºæ—¶ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°æ­¤æ§åˆ¶å°è¾“å‡º

![Program console output](img/15ce053f5a74854e651eb01b002573fe.jpg)

ç¨‹åºæ§åˆ¶å°è¾“å‡º

ä»¥ä¸‹è§†é¢‘æ¼”ç¤ºäº†ç»“æœ

<https://www.youtube.com/embed/Jfuu-h_NYY0>

## ç»“è®º

ä½ è¿˜åœ¨è¯»è¿™ä¸ªå—ï¼Ÿ è°¢è°¢ï¼ è¿™æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„æ•™ç¨‹ğŸ™‚ç°åœ¨ï¼Œåœ¨æ‚¨çŸ¥é“å¦‚ä½•ä½¿ç”¨ Raspberry Pi æ§åˆ¶ç”µæœºä¹‹åï¼Œä¹Ÿè®¸æ‚¨å¯â€‹â€‹ä»¥è€ƒè™‘æ„å»ºä¸€äº›å¾ˆé…·çš„é¡¹ç›®ç”šè‡³æ˜¯ä¸€ä¸ªå°å‹æœºå™¨äººå¹¶ä¸æˆ‘ä»¬åˆ†äº«ç»“æœğŸ™‚

ä¸å¾€å¸¸ä¸€æ ·ï¼Œæˆ‘å–œæ¬¢é˜…è¯»æ‚¨çš„è¯„è®ºå¹¶å›ç­”æ‚¨çš„é—®é¢˜ã€‚ å¦‚æœæ‚¨å–œæ¬¢æœ¬æ•™ç¨‹æˆ–å…¶ä»–æ•™ç¨‹ï¼Œè¯·ä¼ æ’­ï¼

æ‚¨å¯ä»¥åœ¨ GitHub ä¸­æ‰¾åˆ°æ‰€æœ‰é¡¹ç›®æ–‡ä»¶ï¼š [https://github.com/JavaTutorialNetwork/Tutorials/tree/master/RaspberryPiControlMotors](https://github.com/JavaTutorialNetwork/Tutorials/tree/master/RaspberryPiControlMotors)

èµ„æ–™æ¥æºï¼š

[ä½¿ç”¨ Pi å’Œ Python æ§åˆ¶ç›´æµç”µæœº](https://business.tutsplus.com/tutorials/controlling-dc-motors-using-python-with-a-raspberry-pi--cms-20051)